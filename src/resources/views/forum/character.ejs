<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <meta http-equiv="refresh" content="5"> -->
  <title>DETAIL FORUM</title>
  <%- include("../partials/link") %>
  <link rel="icon" href="/image/tablogo.png">
  <link rel="stylesheet" href="/css/forum_detail.css">
  <!----===== Boxicons CSS ===== -->
  <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
  <!-- OWL CAROUSEL -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.theme.default.min.css">
</head>

<body>
  <%- include('../partials/header') %>

  <div class="container">
    <div class="section" id="section-1">
      <div class="row">
        <div class="col-3">
          <div class="info-left">
            <div class="character__name text-center">
              <h2><%= character.title %></h2>
            </div>
            <div class="character__cover">
              <img src="<%= character.images.jpg.image_url %>" width="100%" alt="">
            </div>
            <div class="character__paticals">
              <p>Add to My List</p>
              <hr>
              <p>Add to My Favorites</p>
              <hr>
              <div class="share d-flex flex-wrap justify-content-around">
                <span>
                  <i class="fab fa-2x fa-facebook-square"></i>
                </span>
                <span>
                  <i class="fab fa-2x fa-instagram-square"></i>
                </span>
                <span>
                  <i class="fab fa-2x fa-pinterest-square"></i>
                </span>
                <span>
                  <i class="fab fa-2x fa-tumblr-square"></i>
                </span><span>
                  <i class="fab fa-2x fa-twitter-square"></i>
                </span><span>
                  <i class="fab fa-2x fa-reddit-square"></i>
                </span>
              </div>
              <br>
              <h5>Alternative Titles</h5>
              <hr>
              <span><b>Default Name:</b> <%= character.title %> </span>
              <span><b>Japanese Name:</b> <%= (character.title_japanse) ? character.title_japanse : 'unknown' %> </span>
              <span><b>English Name:</b>
                <%= (character.title_english) ? character.title_english : 'unknown' %> </span>
              <h5 class="mt-4">Information</h5>
              <hr>
              <div><b>Genres:</b>
                <% character.genres.forEach(function(type,index){%>
                <a href="<%= type.url %>" target="_blank">
                  <%= type.name %>
                </a>
                <%}) %>
              </div>
            </div>
          </div>
        </div>
        <div class="col-9">
          <div class="row info-right">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/forum">Forum</a></li>
                <li class="breadcrumb-item active" aria-current="page">Detail</li>
              </ol>
            </nav>
            <ul class="navigation">
              <li><a href="#" class="disabled">Detail</a></li>
              <li><a href="#">Characters</a></li>
              <li><a href="#">Pictures</a></li>
            </ul>
            <div class="statisticals">
              <div class="statisticals__score">
                <span>
                  <p>SCORE</p>
                </span>
                <p class="statisticals__score-score">
                  <span>
                    <b>
                      <%= (character.score)? character.score : 'Not Scored' %>
                    </b>
                  </span>
                </p>
                <p class="statisticals__score-scoredBy">
                  <%= character.scored_by %> users
                </p>
              </div>
              <div class="statisticals__another">
                <div class="general-1">
                  <div class="rank">
                    <p>Ranked <b>#
                        <b data-vanilla-counter data-start-at="0" data-end-at="<%= character.rank %>" data-time="1000"></b>
                      </b></p>
                  </div>
                  <div class="popularity">
                    <p>Popularity <b># <b data-vanilla-counter data-start-at="0" data-end-at="<%= character.popularity %>" data-time="2000"></b></b></p>
                  </div>
                  <div class="members">
                    <p>Members
                      <b><%= character.members %></b>
                    </p>
                  </div>
                  <div class="members">
                    <p>Favorites
                      <b><%= character.favorites %></b>
                    </p>
                  </div>
                </div>
                <div class="general-2">
                  <div class="type">
                    <a href="#">
                      <p><%= character.type %></p>
                    </a>
                  </div>
                  <div class="serializations">
                    <% character.serializations.forEach(function(elm,index){%>
                    <a href="<%= elm.url %> " target="_blank">
                      <p>
                        <%= elm.name %>
                      </p>
                    </a>
                    <%}) %>
                  </div>
                  <div class="authors">
                    <p>
                      <% character.authors.forEach(function(author,index){%>
                      <a href="/forum/author/<%= author.mal_id %> ">
                        <p>
                          <%= author.name %>
                        </p>
                      </a>
                      <%= (index ===  character.authors.length -1) ? '.' : ", " %>
                      <%}) %>
                      (Story & Art)
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="description mt-4">
              <div class="synopsis">
                <h4>Synopsis</h4>
                <hr>
                <p><%= character.synopsis %> </p>
              </div>
              <div class="background">
                <h4>Background</h4>
                <hr>
                <p><%= character.background %> </p>
              </div>
              <div class="types">
                <h4>Types</h4>
                <hr>
                <% character.genres.forEach(function(genre,index){%>
                <a href="<%= genre.url %>" target="_blank">
                  <span class="badge badge-warning">
                    <%= genre.name %>
                  </span>
                </a>
                <%}) %>
              </div>
              <div class="themes mt-4">
                <h4>Themes</h4>
                <hr>
                <% character.themes.forEach(function(theme,index){%>
                <a href="<%= theme.url %>" target="_blank">
                  <span class="badge badge-success">
                    <%= theme.name %>
                  </span>
                </a>
                <%}) %>
              </div>
            </div>
            <div class="characters mt-4">
              <h4>Characters</h4>
              <hr>
              <div class="char-list">
                <% characters.forEach(function(character,index){%>
                <div class="character d-flex <%= (index % 2 === 0)? 'gray' : '' %> ">
                  <a href="/forum/character/<%= character.character.mal_id %>">
                    <img src="<%= character.character.images.jpg.image_url %>" class="character-avatar mb-3" alt="">
                  </a>
                  <div class="character__info d-flex flex-column ml-3">
                    <a href="/forum/character/<%= character.character.mal_id %>">
                      <b><%= character.character.name %> </b>
                    </a>
                    <b>
                      <%= character.role %>
                    </b>
                    <small class="float-right">[
                      <a href="<%= character.character.url %>" target="_blank">source</a>
                      ]</small>
                  </div>
                </div>
                <%}) %>
              </div>
            </div>
            <div class="recommendations mt-4">
              <h4>Recommendations</h4>
              <hr>
              <div class="owl-carousel owl-theme">
                <% recommendations.forEach((character,index)=>{%>
                <div class="character__recommend d-flex flex-column">
                  <a href="/forum/detail/<%= character.entry.mal_id %>" class="character__recommend-title">
                    <img src="<%= character.entry.images.jpg.image_url %>" class="character__recommend-cover" alt="">
                  </a>
                  <div class="text-center">
                    <a href="/forum/detail/<%= character.entry.mal_id %>" class="character__recommend-title">
                      <%= character.entry.title %>
                    </a>
                    <p><%= character.votes %> <i class="fas fa-star text-warning"></i></p>
                    <a href="<%= character.url %>"> read more</a>
                  </div>
                </div>
                <%}) %>
              </div>
            </div>

          </div>
        </div>
      </div>
    </div>
    <div class="section mt-4" id="section-2">
      <div class="row">
        <div class="genres-list"></div>
      </div>
    </div>
  </div>
  <%- include('../partials/footer') %>
</body>
<%- include("../partials/script") %>
<script src="/js/vanilla-counter.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

<script>
  VanillaCounter();

  fetch("/forum/genres").then((res) => res.json()).then((result) => {
    const htmls = result.data.map((elm, index) => `
       <a href="${elm.url}" target="_blank" class="m-1">
      <span class="badge badge-info">
        ${ elm.name } (${elm.count})
      </span>
      </a>
    `).join("")
    document.querySelector('.genres-list').innerHTML = htmls
    console.log(result)
  })
</script>

</html>