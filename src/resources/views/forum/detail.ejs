<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- <meta http-equiv="refresh" content="5"> -->
  <title>DETAIL FORUM</title>
  <%- include("../partials/link") %>
  <link rel="icon" href="/image/tablogo.png">
  <link rel="stylesheet" href="/css/forum_detail.css">
  <!----===== Boxicons CSS ===== -->
  <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
</head>

<body>
  <%- include('../partials/header') %>

  <div class="container">
    <div class="section" id="section-1">
      <div class="row">
        <div class="col-3">
          <div class="info-left">
            <div class="manga__name text-center">
              <h2><%= manga.title %></h2>
            </div>
            <div class="manga__cover">
              <img src="<%= manga.images.jpg.image_url %>" width="100%" alt="">
            </div>
            <div class="manga__paticals">
              <p>Add to My List</p>
              <hr>
              <p>Add to My Favorites</p>
              <hr>
              <div class="share d-flex flex-wrap justify-content-around">
                <span>
                  <i class="fab fa-2x fa-facebook-square"></i>
                </span>
                <span>
                  <i class="fab fa-2x fa-instagram-square"></i>
                </span>
                <span>
                  <i class="fab fa-2x fa-pinterest-square"></i>
                </span>
                <span>
                  <i class="fab fa-2x fa-tumblr-square"></i>
                </span><span>
                  <i class="fab fa-2x fa-twitter-square"></i>
                </span><span>
                  <i class="fab fa-2x fa-reddit-square"></i>
                </span>
              </div>
              <br>
              <h5>Alternative Titles</h5>
              <hr>
              <span><b>Default Name:</b> <%= manga.title %> </span>
              <span><b>Japanese Name:</b> <%= (manga.title_japanse) ? manga.title_japanse : 'unknown' %> </span>
              <span><b>English Name:</b>
                <%= (manga.title_english) ? manga.title_english : 'unknown' %> </span>
              <h5 class="mt-4">Information</h5>
              <hr>
              <div><b>Author:</b> <% manga.authors.forEach(function(author,index){%>
                <a href="/forum/author/<%= author.mal_id %>">
                  <%= author.name %>
                </a>
                <%}) %>
              </div>
              <div><b>Type:</b> <%= (manga.type) ? manga.type : 'unknown'%></div>
              <div><b>Published:</b> <%= (manga.published.string) ?manga.published.string : 'unknown' %></div>
              <div><b>Chapter:</b> <%= (manga.chapters) ? manga.chapters : 'unknown' %></div>
              <div><b>Volumes:</b> <%= (manga.volumes) ? manga.volumes : 'unknown' %></div>
              <div><b>Status:</b>
                <%= (manga.status) ? manga.status : 'unknown' %>
              </div>
              <div><b>Genres:</b>
                <% manga.genres.forEach(function(type,index){%>
                <a href="<%= type.url %>" target="_blank">
                  <%= type.name %>
                </a>
                <%}) %>
              </div>
              <div><b>Demographic:</b>
                <% manga.demographics.forEach(function(demographic,index){%>
                <a href="<%= demographic.url %>" target="_blank">
                  <%= demographic.name %>
                </a>
                <%}) %>
              </div>
              <div><b>Serialization:</b>
                <% manga.serializations.forEach(function(serialization,index){%>
                <a href="<%= serialization.url %>" target="_blank">
                  <%= serialization.name %>
                </a>
                <%}) %>
              </div>
            </div>
          </div>
        </div>
        <div class="col-9">
          <div class="row info-right">
            <nav aria-label="breadcrumb">
              <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="/forum">Forum</a></li>
                <li class="breadcrumb-item active" aria-current="page">Library</li>
              </ol>
            </nav>
            <ul class="navigation">
              <li><a href="#" class="disabled">Detail</a></li>
              <li><a href="/forum/author/<%= manga.authors[0].mal_id %>">Author</a></li>
              <li><a href="#">Characters</a></li>
              <li><a href="#">News</a></li>
              <li><a href="#">Statistics</a></li>
              <li><a href="#">Reviews</a></li>
              <li><a href="#">Recommendations</a></li>
              <li><a href="#">Interest Stacks</a></li>
              <li><a href="#">Forum</a></li>
              <li><a href="#">Clubs</a></li>
              <li><a href="#">Pictures</a></li>
            </ul>
            <div class="statisticals">
              <div class="statisticals__score">
                <span>
                  <p>SCORE</p>
                </span>
                <p class="statisticals__score-score">
                  <span>
                    <b>
                      <%= manga.score %>
                    </b>
                  </span>
                </p>
                <p class="statisticals__score-scoredBy">
                  <%= manga.scored_by %> users
                </p>
              </div>
              <div class="statisticals__another">
                <div class="general-1">
                  <div class="rank">
                    <p>Ranked <b>#
                        <b data-vanilla-counter data-start-at="0" data-end-at="<%= manga.rank %>" data-time="1000"></b>
                      </b></p>
                  </div>
                  <div class="popularity">
                    <p>Popularity <b># <b data-vanilla-counter data-start-at="0" data-end-at="<%= manga.popularity %>" data-time="2000"></b></b></p>
                  </div>
                  <div class="members">
                    <p>Members
                      <b><%= manga.members %></b>
                    </p>
                  </div>
                  <div class="members">
                    <p>Favorites
                      <b><%= manga.favorites %></b>
                    </p>
                  </div>
                </div>
                <div class="general-2">
                  <div class="type">
                    <a href="#">
                      <p><%= manga.type %></p>
                    </a>
                  </div>
                  <div class="serializations">
                    <% manga.serializations.forEach(function(elm,index){%>
                    <a href="<%= elm.url %> " target="_blank">
                      <p>
                        <%= elm.name %>
                      </p>
                    </a>
                    <%}) %>
                  </div>
                  <div class="authors d-flex">
                    <% manga.authors.forEach(function(author,index){%>
                    <a href="/forum/author/<%= author.mal_id %> " target="_blank">
                      <p>
                        <%= author.name %>
                      </p>
                    </a>
                    <%}) %>
                    <p>
                      (Story & Art)
                    </p>
                  </div>
                </div>
              </div>
            </div>
            <div class="description mt-4">
              <div class="synopsis">
                <h4>Synopsis</h4>
                <hr>
                <p><%= manga.synopsis %> </p>
              </div>
              <div class="background">
                <h4>Background</h4>
                <hr>
                <p><%= manga.background %> </p>
              </div>
              <div class="types">
                <h4>Types</h4>
                <hr>
                <% manga.genres.forEach(function(genre,index){%>
                <a href="<%= genre.url %>" target="_blank">
                  <span class="badge badge-warning">
                    <%= genre.name %>
                  </span>
                </a>
                <%}) %>
              </div>
              <div class="themes mt-4">
                <h4>Themes</h4>
                <hr>
                <% manga.themes.forEach(function(theme,index){%>
                <a href="<%= theme.url %>" target="_blank">
                  <span class="badge badge-success">
                    <%= theme.name %>
                  </span>
                </a>
                <%}) %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="section mt-4" id="section-2">
      <div class="row">
        <div class="genres-list"></div>
      </div>
    </div>
  </div>
  <%- include('../partials/footer') %>
</body>
<%- include("../partials/script") %>
<script src="/js/vanilla-counter.js"></script>
<script>
  VanillaCounter();

  fetch("/forum/genres").then((res) => res.json()).then((result) => {
    const htmls = result.data.map((elm, index) => `
       <a href="${elm.url}" target="_blank" class="m-1">
      <span class="badge badge-info">
        ${ elm.name } (${elm.count})
      </span>
      </a>
    `).join("")
    document.querySelector('.genres-list').innerHTML = htmls
    console.log(result)
  })
</script>

</html>